[
 %% SASL config
 {sasl, [
         {sasl_error_logger, {file, "log/sasl-error.log"}},
         {errlog_type, error},
         {error_logger_mf_dir, "log/sasl"},      % Log directory
         {error_logger_mf_maxbytes, 10485760},   % 10 MB max file size
         {error_logger_mf_maxfiles, 5}           % 5 files max
        ]},
 {setup, [
    {data_dir, "."},
    {log_dir, "."}
 ]},
  {kernel, [
    {logger_level, debug},
    {logger, [
      {handler, default, logger_std_h, #{
        level => error,
        formatter => {logger_formatter, #{
          template => [time," [", level, "][",pid,"][", mfa, " #", line,"]\n\t",msg,"\n\n"] }
        },
        filters => [
          {skip_progress_info, {fun logger_filters:progress/2, stop}}
        ]
      }},
      {handler, info, logger_std_h, #{
        level => info,
        config => #{
          file => "log/info.log"
        },
        formatter => {logger_formatter, #{
          template => [time," [", level, "][",pid,"][", mfa, " #", line,"]\n\t",msg,"\n\n"] }
        },
        filters => [
          {skip_progress_info, {fun logger_filters:progress/2, stop}}
        ]
      }},
      {handler, error, logger_std_h, #{
        level => error,
        config => #{
          file => "log/error.log"
        },
        formatter => {logger_formatter, #{
          template => [time," [", level, "][",pid,"][", mfa, " #", line,"]\n\t",msg,"\n\n"] }
        },
        filters => [
          {skip_progress_info, {fun logger_filters:progress/2, stop}}
        ]
      }}
    ]}
  ]},

 {lager, [
   {colored, false},
   {handlers, [
     %{lager_console_backend, [info, {lager_default_formatter, [time," [",severity,"] ", pid, " ", message, "\n"]}]},
     %{lager_file_backend, [{file, "log/error.log"}, {level, error}]},
     %{lager_file_backend, [{file, "log/console.log"}, {level, info}, {formatter, lager_default_formatter},
     %                      {formatter_config, [time," [",severity,"] ", pid, " ", message, "\n"]}]}
   ]},

  {extra_sinks,
   [
    {system_log_lager_event,
     [
      {handlers,
       [
        {lager_file_backend, [{file, "log/system.log"}, {level, info}, {formatter, lager_default_formatter},
                              {formatter_config, [time," [",severity,"] ", pid, " ", message, "\n"]}]}
       ]
      },
      {async_threshold, 500},
      {async_threshold_window, 50}
     ]
    }]
  }

 ]},
 {amqp_client, [
   { prefer_ipv6, false }
 ]}
].

